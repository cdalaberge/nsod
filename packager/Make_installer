# This Makefile is included with binary packages to handle installation only.

install_system: 
	cp nsod_system /usr/bin
	ln -sf /usr/bin/nsod_system /usr/bin/nsod

	mkdir -p /usr/lib/nsod

	cp -r ui /usr/lib/nsod
	cp libnsod_open_hook.so /usr/lib/nsod

	mkdir -p /etc/nsod

	echo "system install finished"

install_user: 
	mkdir -p ~/.nsod/cfg
	mkdir -p ~/.nsod/bin
	mkdir -p ~/.nsod/lib

	cp nsod_user ~/.nsod/bin
	ln -sf ~/.nsod/bin/nsod_user ~/.nsod/bin/nsod

	cp libnsod_open_hook.so ~/.nsod/lib

	cp -r ui ~/.nsod/lib
	
	echo "user install finished";


uninstall_system:
	rm /usr/bin/nsod
	rm /usr/bin/nsod_system

	rm -r /usr/lib/nsod
	rm -r /etc/nsod

uninstall_user:
	rm -r ~/.nsod


# may be needed for compatiblity with older libc versions.
compile:
	gcc -shared -fPIC -I c c/nsod_open_hook.c -o ./libnsod_open_hook.so -L. -l:libnsod_rust.a -ldl