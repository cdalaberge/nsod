# This Makefile is included with binary packages to handle installation only.

system_install: 
	cp build/nsod_system /usr/bin
	ln -sf /usr/bin/nsod_system /usr/bin/nsod

	mkdir -p /usr/lib/nsod

	cp -r ui /usr/lib/nsod
	cp build/libnsod_open_hook.so /usr/lib/nsod

	mkdir -p /etc/nsod

	echo "system install finished"

user_install: 
	mkdir -p "$(HOME)/.nsod/cfg"
	mkdir -p "$(HOME)/.nsod/bin"
	mkdir -p "$(HOME)/.nsod/lib"

	cp build/nsod_user "$(HOME)/.nsod/bin"
	ln -sf "$(HOME)/.nsod/bin/nsod_user" "$(HOME)/.nsod/bin/nsod"

	cp build/libnsod_open_hook.so "$(HOME)/.nsod/lib"

	cp -r ui "$(HOME)/.nsod/lib"
	
	echo "user install finished";


system_uninstall:
	rm -f /usr/bin/nsod
	rm -f /usr/bin/nsod_system

	rm -rf /usr/lib/nsod
	rm -rf /etc/nsod

user_uninstall:
	rm -rf "$(HOME)/.nsod"


# may be needed for compatiblity with older libc versions.
compile:
	gcc -shared -fPIC -I c c/nsod_open_hook.c -o ./libnsod_open_hook.so -L. -l:libnsod_rust.a -ldl